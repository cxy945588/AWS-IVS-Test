# AWS IVS Real-Time Streaming æ¸¬è©¦ç’°å¢ƒ

é€™æ˜¯ä¸€å€‹å®Œæ•´çš„ Amazon IVS Real-Time Streaming æ¸¬è©¦ç’°å¢ƒï¼Œæ”¯æ´**è¶…ä½å»¶é² (<500ms)** çš„å³æ™‚ç›´æ’­ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹è‰²

- âœ… **è¶…ä½å»¶é²**: WebRTC æŠ€è¡“ï¼Œå»¶é² < 300-500ms
- âœ… **æ”¯æ´ 1000+ è§€çœ¾**: å¯æ“´å±•çš„å³æ™‚ç›´æ’­
- âœ… **å®Œæ•´ UI**: ä¸»æ’­æ§åˆ¶å°å’Œè§€çœ¾ç«¯ä»‹é¢
- âœ… **å³æ™‚ç›£æ§**: é€£ç·šç‹€æ…‹ã€ç›´æ’­æ™‚é•·ã€åƒèˆ‡è€…æ•¸é‡
- âœ… **æ—¥èªŒè¿½è¹¤**: è©³ç´°çš„äº‹ä»¶æ—¥èªŒ
- âœ… **GitHub Pages å°±ç·’**: å¯ç›´æ¥éƒ¨ç½²åˆ° GitHub Pages

## ğŸ“ æª”æ¡ˆçµæ§‹

```
AWS-IVS/
â”œâ”€â”€ index.html          # é¦–é å°èˆª
â”œâ”€â”€ broadcaster.html    # ä¸»æ’­ç«¯é é¢
â”œâ”€â”€ viewer.html         # è§€çœ¾ç«¯é é¢
â””â”€â”€ README.md          # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ­¥é©Ÿ 1: åœ¨ AWS Console å»ºç«‹ Stage

1. ç™»å…¥ [AWS Console](https://console.aws.amazon.com/)
2. æœå°‹ä¸¦é€²å…¥ **"Amazon IVS"** æœå‹™
3. é¸æ“‡ **"Real-time streaming"**
4. é»æ“Š **"Create stage"**
5. è¨­å®šï¼š
   - **Stage name**: `test-stage` (æˆ–ä»»æ„åç¨±)
   - å…¶ä»–ä¿æŒé è¨­å€¼
6. é»æ“Š **"Create stage"**
7. **è¨˜ä¸‹ Stage ARN** (æ ¼å¼: `arn:aws:ivs:region:account-id:stage/xxxx`)

### æ­¥é©Ÿ 2: ç”Ÿæˆ Participant Token

ä½¿ç”¨ AWS CLI ç”Ÿæˆ Tokenï¼ˆéœ€è¦å…ˆå®‰è£ä¸¦è¨­å®š AWS CLIï¼‰

#### å®‰è£ AWS CLI (å¦‚æœå°šæœªå®‰è£)

```bash
# Windows (ä½¿ç”¨ MSI å®‰è£ç¨‹å¼)
# ä¸‹è¼‰: https://awscli.amazonaws.com/AWSCLIV2.msi

# macOS
brew install awscli

# Linux
pip install awscli
```

#### è¨­å®š AWS CLI

```bash
aws configure
# è¼¸å…¥ä½ çš„ AWS Access Key ID
# è¼¸å…¥ä½ çš„ AWS Secret Access Key
# è¼¸å…¥ Region (ä¾‹å¦‚: us-west-2)
# è¼¸å…¥ Output format (å»ºè­°: json)
```

#### ç”Ÿæˆä¸»æ’­ Token

```bash
aws ivs-realtime create-participant-token \
  --stage-arn "arn:aws:ivs:us-west-2:123456789012:stage/xxxxxxxxxxxx" \
  --capabilities PUBLISH SUBSCRIBE \
  --duration 7200 \
  --user-id "broadcaster-1" \
  --query 'participantToken.token' \
  --output text
```

#### ç”Ÿæˆè§€çœ¾ Token

```bash
aws ivs-realtime create-participant-token \
  --stage-arn "arn:aws:ivs:us-west-2:123456789012:stage/xxxxxxxxxxxx" \
  --capabilities SUBSCRIBE \
  --duration 7200 \
  --user-id "viewer-1" \
  --query 'participantToken.token' \
  --output text
```

**åƒæ•¸èªªæ˜ï¼š**
- `--stage-arn`: ä½ çš„ Stage ARN
- `--capabilities`: 
  - `PUBLISH SUBSCRIBE`: ä¸»æ’­æ¬Šé™ï¼ˆå¯æ¨æµå’Œæ¥æ”¶ï¼‰
  - `SUBSCRIBE`: è§€çœ¾æ¬Šé™ï¼ˆåƒ…æ¥æ”¶ï¼‰
- `--duration`: Token æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰ï¼Œæœ€é•· 7200 ç§’ï¼ˆ2å°æ™‚ï¼‰
- `--user-id`: ä½¿ç”¨è€… IDï¼ˆå¯è‡ªè¨‚ï¼‰

### æ­¥é©Ÿ 3: æ¸¬è©¦ç›´æ’­

#### æ–¹æ³• A: æœ¬åœ°æ¸¬è©¦

1. å°‡æ•´å€‹ `AWS-IVS` è³‡æ–™å¤¾æ”¾åˆ°ä»»æ„ä½ç½®
2. ç”¨ç€è¦½å™¨ç›´æ¥é–‹å•Ÿ `index.html`
3. é»æ“Šã€Œä¸»æ’­ç«¯ã€ï¼Œè²¼ä¸Šä¸»æ’­ Tokenï¼Œé–‹å§‹ç›´æ’­
4. å¦é–‹åˆ†é é»æ“Šã€Œè§€çœ¾ç«¯ã€ï¼Œè²¼ä¸Šè§€çœ¾ Tokenï¼Œé–‹å§‹è§€çœ‹

#### æ–¹æ³• B: GitHub Pages éƒ¨ç½²

1. åœ¨ GitHub å»ºç«‹æ–° repository
2. ä¸Šå‚³é€™äº›æª”æ¡ˆ
3. é€²å…¥ Settings â†’ Pages
4. Source é¸æ“‡ `main` branch
5. å„²å­˜å¾Œæœƒå¾—åˆ°ä¸€å€‹ URLï¼Œä¾‹å¦‚ï¼š`https://yourusername.github.io/repo-name/`
6. è¨ªå•è©² URL é–‹å§‹æ¸¬è©¦

## ğŸ® ä½¿ç”¨èªªæ˜

### ä¸»æ’­ç«¯æ“ä½œ

1. é–‹å•Ÿ `broadcaster.html`
2. è²¼ä¸Šä¸»æ’­ Tokenï¼ˆéœ€è¦ PUBLISH,SUBSCRIBE æ¬Šé™ï¼‰
3. é»æ“Šã€Œé–‹å§‹ç›´æ’­ã€
4. å…è¨±ç€è¦½å™¨ä½¿ç”¨æ”åƒé ­å’Œéº¥å…‹é¢¨
5. é–‹å§‹ç›´æ’­å¾Œï¼Œè§€å¯Ÿï¼š
   - é€£ç·šç‹€æ…‹
   - æ”åƒé ­/éº¥å…‹é¢¨ç‹€æ…‹
   - ç›´æ’­æ™‚é•·
   - æ—¥èªŒè¨Šæ¯

### è§€çœ¾ç«¯æ“ä½œ

1. é–‹å•Ÿ `viewer.html`
2. è²¼ä¸Šè§€çœ¾ Tokenï¼ˆåªéœ€è¦ SUBSCRIBE æ¬Šé™ï¼‰
3. é»æ“Šã€Œé–‹å§‹è§€çœ‹ã€
4. ç­‰å¾…ä¸»æ’­é–‹å§‹ç›´æ’­
5. æ”¶åˆ°ä¸²æµå¾Œè‡ªå‹•æ’­æ”¾ï¼ˆå¦‚ç„¡æ³•è‡ªå‹•æ’­æ”¾è«‹æ‰‹å‹•é»æ“Šæ’­æ”¾æŒ‰éˆ•ï¼‰
6. è§€å¯Ÿï¼š
   - é€£ç·šç‹€æ…‹
   - è¦–é »ç‹€æ…‹
   - è§€çœ‹æ™‚é•·
   - åœ¨ç·šåƒèˆ‡è€…æ•¸é‡

### å¤šäººæ¸¬è©¦

- å¯ä»¥é–‹å•Ÿå¤šå€‹ç€è¦½å™¨åˆ†é æˆ–è¦–çª—ä½œç‚ºè§€çœ¾
- æ¯å€‹è§€çœ¾éœ€è¦ä½¿ç”¨ä¸åŒçš„ `user-id` ç”Ÿæˆ Token
- æˆ–ä½¿ç”¨ç›¸åŒ Tokenï¼ˆä½†å»ºè­°ç‚ºæ¯å€‹è§€çœ¾ç”Ÿæˆç¨ç«‹ Tokenï¼‰

## ğŸ” æ¸¬è©¦å»¶é²

1. åœ¨ä¸»æ’­ç«¯é¡¯ç¤ºä¸€å€‹è¨ˆæ™‚å™¨æˆ–æ®æ‰‹
2. è§€å¯Ÿè§€çœ¾ç«¯çš„å»¶é²æ™‚é–“
3. æ­£å¸¸æƒ…æ³ä¸‹å»¶é²æ‡‰è©²åœ¨ 300-500ms ä¹‹é–“

## ğŸ’° æˆæœ¬ä¼°ç®—

IVS Real-Time æŒ‰ **Participant Hours** è¨ˆè²»ï¼š

| å ´æ™¯ | è¨ˆç®—æ–¹å¼ | ä¼°ç®—æˆæœ¬ (ç¾åœ‹å€) |
|------|---------|-----------------|
| 1 ä¸»æ’­ + 10 è§€çœ¾ï¼Œ1 å°æ™‚ | (1+10) Ã— 1 = 11 participant hours | ~$0.11 USD |
| 1 ä¸»æ’­ + 100 è§€çœ¾ï¼Œ1 å°æ™‚ | (1+100) Ã— 1 = 101 participant hours | ~$1.01 USD |
| 1 ä¸»æ’­ + 1000 è§€çœ¾ï¼Œ1 å°æ™‚ | (1+1000) Ã— 1 = 1001 participant hours | ~$10.01 USD |

**æ³¨æ„ï¼š**
- å¯¦éš›åƒ¹æ ¼ä¾å€åŸŸè€Œç•°
- è©³ç´°å®šåƒ¹è«‹åƒè€ƒ [AWS IVS å®šåƒ¹é é¢](https://aws.amazon.com/ivs/pricing/)
- æ¸¬è©¦å®Œè¨˜å¾—åœæ­¢ç›´æ’­ä¸¦åˆªé™¤ Stage

## âš ï¸ æ³¨æ„äº‹é …

### ç€è¦½å™¨ç›¸å®¹æ€§

æ¨è–¦ä½¿ç”¨ä»¥ä¸‹ç€è¦½å™¨ï¼š
- âœ… Chrome / Edge (Chromium) - æœ€ä½³æ”¯æ´
- âœ… Firefox
- âœ… Safari (éœ€è¦è¼ƒæ–°ç‰ˆæœ¬)
- âŒ ä¸æ”¯æ´ IE

### Token ç®¡ç†

- Token æœ‰æ•ˆæœŸæœ€é•· 2 å°æ™‚ï¼ˆ7200 ç§’ï¼‰
- Token éæœŸéœ€è¦é‡æ–°ç”Ÿæˆ
- ç”Ÿç”¢ç’°å¢ƒæ‡‰ä½¿ç”¨å¾Œç«¯ API å‹•æ…‹ç”Ÿæˆ Token
- ä¸è¦åœ¨å‰ç«¯æˆ–ç‰ˆæœ¬æ§åˆ¶ç³»çµ±ä¸­ç¡¬ç·¨ç¢¼ Token

### ç¶²è·¯éœ€æ±‚

- ä¸»æ’­ç«¯ï¼šä¸Šå‚³é€Ÿåº¦å»ºè­° â‰¥ 3 Mbps
- è§€çœ¾ç«¯ï¼šä¸‹è¼‰é€Ÿåº¦å»ºè­° â‰¥ 2 Mbps
- ç¶²è·¯ä¸ç©©å®šå¯èƒ½å°è‡´å¡é “æˆ–æ–·ç·š

### å®‰å…¨æ€§

- æœ¬ç¯„ä¾‹ç‚ºæ¸¬è©¦ç”¨é€”ï¼Œç›´æ¥åœ¨å‰ç«¯è¼¸å…¥ Token
- **ç”Ÿç”¢ç’°å¢ƒå¿…é ˆ**ï¼š
  - å¾Œç«¯ç”Ÿæˆå’Œé©—è­‰ Token
  - å¯¦ä½œèº«ä»½é©—è­‰
  - åŠ å…¥æ¬Šé™æ§åˆ¶
  - ç›£æ§ç•°å¸¸è¡Œç‚º

## ğŸ› å¸¸è¦‹å•é¡Œæ’è§£

### å•é¡Œ 1: ç„¡æ³•ç²å–æ”åƒé ­æ¬Šé™

**è§£æ±ºæ–¹æ³•ï¼š**
- ç¢ºä¿ä½¿ç”¨ HTTPS æˆ– localhost
- æª¢æŸ¥ç€è¦½å™¨æ¬Šé™è¨­å®š
- ç¢ºèªæ”åƒé ­æœªè¢«å…¶ä»–æ‡‰ç”¨ç¨‹å¼å ç”¨

### å•é¡Œ 2: è§€çœ¾çœ‹ä¸åˆ°ç•«é¢

**å¯èƒ½åŸå› ï¼š**
- ä¸»æ’­å°šæœªé–‹å§‹ç›´æ’­
- Token æ¬Šé™ä¸æ­£ç¢º
- ç¶²è·¯é€£ç·šå•é¡Œ
- Token å·²éæœŸ

**è§£æ±ºæ–¹æ³•ï¼š**
1. ç¢ºèªä¸»æ’­å·²æˆåŠŸé–‹æ’­ï¼ˆæŸ¥çœ‹ä¸»æ’­ç«¯ç‹€æ…‹ï¼‰
2. æª¢æŸ¥ Token æ˜¯å¦æœ‰ SUBSCRIBE æ¬Šé™
3. æŸ¥çœ‹ç€è¦½å™¨ Console çš„éŒ¯èª¤è¨Šæ¯
4. é‡æ–°ç”Ÿæˆ Token

### å•é¡Œ 3: å»¶é²éé«˜

**å¯èƒ½åŸå› ï¼š**
- ç¶²è·¯å“è³ªä¸ä½³
- è£ç½®æ€§èƒ½ä¸è¶³
- å€åŸŸè·é›¢éé 

**è§£æ±ºæ–¹æ³•ï¼š**
- ä½¿ç”¨æœ‰ç·šç¶²è·¯
- é¸æ“‡è¼ƒè¿‘çš„ AWS å€åŸŸ
- é™ä½è¦–é »è§£æåº¦

### å•é¡Œ 4: "Failed to join stage" éŒ¯èª¤

**å¯èƒ½åŸå› ï¼š**
- Token ç„¡æ•ˆæˆ–éæœŸ
- Stage ARN éŒ¯èª¤
- AWS æ†‘è­‰å•é¡Œ

**è§£æ±ºæ–¹æ³•ï¼š**
- é‡æ–°ç”Ÿæˆ Token
- ç¢ºèª Stage ARN æ­£ç¢º
- æª¢æŸ¥ AWS CLI è¨­å®š

## ğŸ“š é€²éšä½¿ç”¨

### è‡ªè¨‚è¦–é »å“è³ª

ä¿®æ”¹ `broadcaster.html` ä¸­çš„è¦–é »è¨­å®šï¼š

```javascript
mediaStream = await navigator.mediaDevices.getUserMedia({
    video: {
        width: { ideal: 1920 },   // èª¿æ•´å¯¬åº¦
        height: { ideal: 1080 },  // èª¿æ•´é«˜åº¦
        frameRate: { ideal: 30 }  // èª¿æ•´å¹€ç‡
    },
    audio: {
        echoCancellation: true,
        noiseSuppression: true,
        autoGainControl: true
    }
});
```

### æ•´åˆå¾Œç«¯ API

ç”Ÿç”¢ç’°å¢ƒæ‡‰è©²ï¼š

1. **å»ºç«‹å¾Œç«¯ API** (Lambda + API Gateway)
2. **å¯¦ä½œ Token ç”Ÿæˆé‚è¼¯**
3. **åŠ å…¥èº«ä»½é©—è­‰**
4. **å‰ç«¯é€é API ç²å– Token**

ç¯„ä¾‹æ¶æ§‹ï¼š
```
å‰ç«¯ â†’ API Gateway â†’ Lambda â†’ IVS create-participant-token â†’ è¿”å› Token
```

## ğŸ”— ç›¸é—œè³‡æº

- [AWS IVS Real-Time å®˜æ–¹æ–‡æª”](https://docs.aws.amazon.com/ivs/latest/RealTimeUserGuide/)
- [IVS Web Broadcast SDK](https://docs.aws.amazon.com/ivs/latest/RealTimeUserGuide/broadcast.html)
- [AWS CLI åƒè€ƒ](https://docs.aws.amazon.com/cli/latest/reference/ivs-realtime/)
- [å®šåƒ¹è³‡è¨Š](https://aws.amazon.com/ivs/pricing/)

## ğŸ“ æˆæ¬Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›å­¸ç¿’å’Œæ¸¬è©¦ä½¿ç”¨ã€‚

## ğŸ¤ è²¢ç»

æ­¡è¿æå‡º Issue æˆ– Pull Requestï¼

---

**ç¥ä½ æ¸¬è©¦é †åˆ©ï¼ ğŸ‰**

å¦‚æœ‰å•é¡Œï¼Œè«‹æŸ¥çœ‹æ—¥èªŒæˆ–ç€è¦½å™¨ Console ç²å–æ›´å¤šè³‡è¨Šã€‚
